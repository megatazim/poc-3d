define(["./defaultValue-6195d6e4","./Ellipsoid-9d24693d","./Rectangle-f1a1bbf0","./arrayFill-6162b951","./buildModuleUrl-89a61082","./Cartesian3-6ab6e817","./Cartographic-84b54204","./ComponentDatatype-9e683007","./Check-d771f3f9","./GeometryAttribute-b7129781","./GeometryAttributes-bc1c2f3f","./GeometryOffsetAttribute-da5a1d35","./IndexDatatype-7f829734","./Math-77022010","./PolygonPipeline-5d307ca1","./PrimitiveType-5db31a9b","./RectangleGeometryLibrary-b94bd5b3","./FeatureDetection-d5e675a3","./defer-a21481c0","./Event-8b63693e","./RuntimeError-3afc2b48","./WebGLConstants-92042d9e","./Cartesian4-da892aa1","./EllipsoidRhumbLine-7f7a0363"],(function(e,t,i,a,r,n,o,s,u,l,c,h,d,p,f,g,b,_,v,y,m,w,A,E){"use strict";var x=new r.i,D=new r.i,P=new n.o,H=new i.h;function k(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,u=a,h=2,p=0,f=4;n&&(h-=1,u-=1,p+=1,f-=2),o&&(h-=1,u-=1,p+=1,f-=2),p+=h*r+2*u-f;var _,v=new Float64Array(3*p),y=0,m=0,w=P;if(n)b.j.computePosition(t,i,!1,m,0,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;else for(_=0;_<r;_++)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(_=r-1,m=1;m<a;m++)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;if(m=a-1,!o)for(_=r-2;_>=0;_--)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(_=0,m=a-2;m>0;m--)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(var A=v.length/3*2,E=d.IndexDatatype.createTypedArray(v.length/3,A),x=0,D=0;D<v.length/3-1;D++)E[x++]=D,E[x++]=D+1;E[x++]=v.length/3-1,E[x++]=0;var H=new l.I({attributes:new c.a,primitiveType:g._0x1da42a.LINES});return H.attributes.position=new l.o({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v}),H.indices=E,H}function L(a){var r=(a=e.u(a,e.u.EMPTY_OBJECT)).rectangle,n=e.u(a.granularity,p.e.RADIANS_PER_DEGREE),o=e.u(a.ellipsoid,t.t.WGS84),s=e.u(a.rotation,0);if(!e.e(r))throw new u.t("rectangle is required.");if(i.h.validate(r),r.north<r.south)throw new u.t("options.rectangle.north must be greater than options.rectangle.south");var l=e.u(a.height,0),c=e.u(a.extrudedHeight,l);this._rectangle=i.h.clone(r),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(l,c),this._rotation=s,this._extrudedHeight=Math.min(l,c),this._offsetAttribute=a.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}L.packedLength=i.h.packedLength+t.t.packedLength+5,L.pack=function(a,r,n){if(!e.e(a))throw new u.t("value is required");if(!e.e(r))throw new u.t("array is required");return n=e.u(n,0),i.h.pack(a._rectangle,r,n),n+=i.h.packedLength,t.t.pack(a._ellipsoid,r,n),n+=t.t.packedLength,r[n++]=a._granularity,r[n++]=a._surfaceHeight,r[n++]=a._rotation,r[n++]=a._extrudedHeight,r[n]=e.u(a._offsetAttribute,-1),r};var N=new i.h,G=t.t.clone(t.t.UNIT_SPHERE),C={rectangle:N,ellipsoid:G,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};L.unpack=function(a,r,n){if(!e.e(a))throw new u.t("array is required");r=e.u(r,0);var o=i.h.unpack(a,r,N);r+=i.h.packedLength;var s=t.t.unpack(a,r,G);r+=t.t.packedLength;var l=a[r++],c=a[r++],h=a[r++],d=a[r++],p=a[r];return e.e(n)?(n._rectangle=i.h.clone(o,n._rectangle),n._ellipsoid=t.t.clone(s,n._ellipsoid),n._surfaceHeight=c,n._rotation=h,n._extrudedHeight=d,n._offsetAttribute=-1===p?void 0:p,n):(C.granularity=l,C.height=c,C.rotation=h,C.extrudedHeight=d,C.offsetAttribute=-1===p?void 0:p,new L(C))};var I=new o.a;return L.createGeometry=function(t){var i,n,o=t._rectangle,u=t._ellipsoid,c=b.j.computeOptions(o,t._granularity,t._rotation,0,H,I);if(!p.e.equalsEpsilon(o.north,o.south,p.e.EPSILON10)&&!p.e.equalsEpsilon(o.east,o.west,p.e.EPSILON10)){var _,v=t._surfaceHeight,y=t._extrudedHeight;if(!p.e.equalsEpsilon(v,y,0,p.e.EPSILON2)){if(i=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,s=k(e,t),u=t.height,l=t.width,c=f.A.scaleToGeodeticHeight(s.attributes.position.values,o,r,!1),h=c.length,p=new Float64Array(2*h);p.set(c);var g=f.A.scaleToGeodeticHeight(s.attributes.position.values,n,r);p.set(g,h),s.attributes.position.values=p;var b=t.northCap,_=t.southCap,v=4;b&&(v-=1),_&&(v-=1);var y,m=2*(p.length/3+v),w=d.IndexDatatype.createTypedArray(p.length/3,m);h=p.length/6;for(var A=0,E=0;E<h-1;E++)w[A++]=E,w[A++]=E+1,w[A++]=E+h,w[A++]=E+h+1;if(w[A++]=h-1,w[A++]=0,w[A++]=h+h-1,w[A++]=h,w[A++]=0,w[A++]=h,b)y=u-1;else{var x=l-1;w[A++]=x,w[A++]=x+h,y=l+u-2}if(w[A++]=y,w[A++]=y+h,!_){var D=l+y-1;w[A++]=D,w[A]=D+h}return s.indices=w,s}(t,c),e.e(t._offsetAttribute)){var m=i.attributes.position.values.length/3,w=new Uint8Array(m);t._offsetAttribute===h.z.TOP?w=a.d(w,1,0,m/2):(_=t._offsetAttribute===h.z.NONE?0:1,w=a.d(w,_)),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var A=r.i.fromRectangle3D(o,u,v,D),E=r.i.fromRectangle3D(o,u,y,x);n=r.i.union(A,E)}else{if((i=k(t,c)).attributes.position.values=f.A.scaleToGeodeticHeight(i.attributes.position.values,v,u,!1),e.e(t._offsetAttribute)){var P=i.attributes.position.values.length,L=new Uint8Array(P/3);_=t._offsetAttribute===h.z.NONE?0:1,a.d(L,_),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}n=r.i.fromRectangle3D(o,u,v)}return new l.I({attributes:i.attributes,indices:i.indices,primitiveType:g._0x1da42a.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(a,r){return e.e(r)&&(a=L.unpack(a,r)),a._ellipsoid=t.t.clone(a._ellipsoid),a._rectangle=i.h.clone(a._rectangle),L.createGeometry(a)}}));
