define(["./arrayRemoveDuplicates-a80848e1","./BoundingRectangle-330469e1","./buildModuleUrl-89a61082","./Ellipsoid-9d24693d","./Cartesian3-6ab6e817","./Check-d771f3f9","./ComponentDatatype-9e683007","./CoplanarPolygonGeometryLibrary-144b72ed","./defaultValue-6195d6e4","./GeometryAttribute-b7129781","./GeometryAttributes-bc1c2f3f","./GeometryInstance-2e0c38c0","./GeometryPipeline-e9b54c6d","./IndexDatatype-7f829734","./Math-77022010","./FeatureDetection-d5e675a3","./PolygonGeometryLibrary-6924f62a","./PolygonPipeline-5d307ca1","./PrimitiveType-5db31a9b","./VertexFormat-8dc15345","./Cartographic-84b54204","./Rectangle-f1a1bbf0","./defer-a21481c0","./Event-8b63693e","./RuntimeError-3afc2b48","./WebGLConstants-92042d9e","./OrientedBoundingBox-79dc8435","./Cartesian4-da892aa1","./EllipsoidTangentPlane-f8d45d42","./IntersectionTests-0125ff6b","./Plane-588042d8","./AttributeCompression-f1ba21d8","./EncodedCartesian3-aa410950","./ArcType-198c1070","./EllipsoidRhumbLine-7f7a0363"],(function(e,t,n,o,a,r,i,p,s,l,c,y,u,d,g,m,v,h,f,b,w,A,P,x,T,D,F,_,k,L,E,C,R,I,H){"use strict";var G=new a.o,O=new t.f,B=new o.o,z=new o.o,N=new a.o,S=new a.o,j=new a.o,M=new a.o,U=new a.o,V=new a.o,Y=new l.n,q=new m.p,J=new m.p,Q=new a.o;function W(e,t,n,r,p,s,y,u){var v=e.positions,b=h.A.triangulate(e.positions2D,e.holes);b.length<3&&(b=[0,1,2]);var w=d.IndexDatatype.createTypedArray(v.length,b.length);w.set(b);var A=q;if(0!==r){var P=l.n.fromAxisAngle(s,r,Y);if(A=m.p.fromQuaternion(P,A),t.tangent||t.bitangent){P=l.n.fromAxisAngle(s,-r,Y);var x=m.p.fromQuaternion(P,J);y=a.o.normalize(m.p.multiplyByVector(x,y,y),y),t.bitangent&&(u=a.o.normalize(a.o.cross(s,y,u),u))}}else A=m.p.clone(m.p.IDENTITY,A);var T=z;t.st&&(T.x=n.x,T.y=n.y);for(var D=v.length,F=3*D,_=new Float64Array(F),k=t.normal?new Float32Array(F):void 0,L=t.tangent?new Float32Array(F):void 0,E=t.bitangent?new Float32Array(F):void 0,C=t.st?new Float32Array(2*D):void 0,R=0,I=0,H=0,O=0,N=0,S=0;S<D;S++){var j=v[S];if(_[R++]=j.x,_[R++]=j.y,_[R++]=j.z,t.st){var M=p(m.p.multiplyByVector(A,j,G),B);o.o.subtract(M,T,M);var U=g.e.clamp(M.x/n.width,0,1),V=g.e.clamp(M.y/n.height,0,1);C[N++]=U,C[N++]=V}t.normal&&(k[I++]=s.x,k[I++]=s.y,k[I++]=s.z),t.tangent&&(L[O++]=y.x,L[O++]=y.y,L[O++]=y.z),t.bitangent&&(E[H++]=u.x,E[H++]=u.y,E[H++]=u.z)}var Q=new c.a;return t.position&&(Q.position=new l.o({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:_})),t.normal&&(Q.normal=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:k})),t.tangent&&(Q.tangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:L})),t.bitangent&&(Q.bitangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:E})),t.st&&(Q.st=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:C})),new l.I({attributes:Q,indices:w,primitiveType:f._0x1da42a.TRIANGLES})}function Z(e){var t=(e=s.u(e,s.u.EMPTY_OBJECT)).polygonHierarchy;r.o.defined("options.polygonHierarchy",t);var n=s.u(e.vertexFormat,b.n.DEFAULT);this._vertexFormat=b.n.clone(n),this._polygonHierarchy=t,this._stRotation=s.u(e.stRotation,0),this._ellipsoid=o.t.clone(s.u(e.ellipsoid,o.t.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=v.l.computeHierarchyPackedLength(t)+b.n.packedLength+o.t.packedLength+2}Z.fromPositions=function(e){return e=s.u(e,s.u.EMPTY_OBJECT),r.o.defined("options.positions",e.positions),new Z({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},Z.pack=function(e,t,n){return r.o.typeOf.object("value",e),r.o.defined("array",t),n=s.u(n,0),n=v.l.packPolygonHierarchy(e._polygonHierarchy,t,n),o.t.pack(e._ellipsoid,t,n),n+=o.t.packedLength,b.n.pack(e._vertexFormat,t,n),n+=b.n.packedLength,t[n++]=e._stRotation,t[n]=e.packedLength,t};var K=o.t.clone(o.t.UNIT_SPHERE),X=new b.n,$={polygonHierarchy:{}};return Z.unpack=function(e,t,n){r.o.defined("array",e),t=s.u(t,0);var a=v.l.unpackPolygonHierarchy(e,t);t=a.startingIndex,delete a.startingIndex;var i=o.t.unpack(e,t,K);t+=o.t.packedLength;var p=b.n.unpack(e,t,X);t+=b.n.packedLength;var l=e[t++],c=e[t];return s.e(n)||(n=new Z($)),n._polygonHierarchy=a,n._ellipsoid=o.t.clone(i,n._ellipsoid),n._vertexFormat=b.n.clone(p,n._vertexFormat),n._stRotation=l,n.packedLength=c,n},Z.createGeometry=function(t){var o=t._vertexFormat,r=t._polygonHierarchy,i=t._stRotation,s=r.positions;if(!((s=e.D(s,a.o.equalsEpsilon,!0)).length<3)){var c=N,m=S,h=j,f=U,b=V;if(p.g.computeProjectTo2DArguments(s,M,f,b)){if(c=a.o.cross(f,b,c),c=a.o.normalize(c,c),!a.o.equalsEpsilon(M,a.o.ZERO,g.e.EPSILON6)){var w=t._ellipsoid.geodeticSurfaceNormal(M,Q);a.o.dot(c,w)<0&&(c=a.o.negate(c,c),f=a.o.negate(f,f))}var A=p.g.createProjectPointsTo2DFunction(M,f,b),P=p.g.createProjectPointTo2DFunction(M,f,b);o.tangent&&(m=a.o.clone(f,m)),o.bitangent&&(h=a.o.clone(b,h));var x=v.l.polygonsFromHierarchy(r,A,!1),T=x.hierarchy,D=x.polygons;if(0!==T.length){s=T[0].outerRing;for(var F=n.i.fromPoints(s),_=v.l.computeBoundingRectangle(c,P,s,i,O),k=[],L=0;L<D.length;L++){var E=new y.d({geometry:W(D[L],o,_,i,P,c,m,h)});k.push(E)}var C=u.k.combineInstances(k)[0];C.attributes.position.values=new Float64Array(C.attributes.position.values),C.indices=d.IndexDatatype.createTypedArray(C.attributes.position.values.length/3,C.indices);var R=C.attributes;return o.position||delete R.position,new l.I({attributes:R,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:F})}}}},function(e,t){return s.e(t)&&(e=Z.unpack(e,t)),Z.createGeometry(e)}}));
