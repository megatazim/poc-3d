define(["./defaultValue-6195d6e4","./Ellipsoid-9d24693d","./ArcType-198c1070","./arrayFill-6162b951","./buildModuleUrl-89a61082","./Check-d771f3f9","./ComponentDatatype-9e683007","./EllipsoidTangentPlane-f8d45d42","./GeometryAttribute-b7129781","./GeometryAttributes-bc1c2f3f","./GeometryInstance-2e0c38c0","./GeometryOffsetAttribute-da5a1d35","./GeometryPipeline-e9b54c6d","./IndexDatatype-7f829734","./Math-77022010","./PolygonGeometryLibrary-6924f62a","./PolygonPipeline-5d307ca1","./PrimitiveType-5db31a9b","./Cartesian3-6ab6e817","./Cartographic-84b54204","./FeatureDetection-d5e675a3","./defer-a21481c0","./Rectangle-f1a1bbf0","./Event-8b63693e","./RuntimeError-3afc2b48","./WebGLConstants-92042d9e","./Cartesian4-da892aa1","./IntersectionTests-0125ff6b","./Plane-588042d8","./AttributeCompression-f1ba21d8","./EncodedCartesian3-aa410950","./arrayRemoveDuplicates-a80848e1","./EllipsoidRhumbLine-7f7a0363"],(function(e,t,i,r,o,n,a,s,p,u,l,d,y,c,h,f,g,b,m,v,_,E,H,P,A,L,T,C,D,I,O,x,w){"use strict";var G=[],R=[];function S(e,t,r,o,n){var d=s.f.fromPoints(t,e).projectPointsOntoPlane(t,G);g.A.computeWindingOrder2D(d)===g.W.CLOCKWISE&&(d.reverse(),t=t.slice().reverse());var y,h,m=t.length,v=0;if(o)for(y=new Float64Array(2*m*3),h=0;h<m;h++){var _=t[h],E=t[(h+1)%m];y[v++]=_.x,y[v++]=_.y,y[v++]=_.z,y[v++]=E.x,y[v++]=E.y,y[v++]=E.z}else{var H=0;if(n===i.L.GEODESIC)for(h=0;h<m;h++)H+=f.l.subdivideLineCount(t[h],t[(h+1)%m],r);else if(n===i.L.RHUMB)for(h=0;h<m;h++)H+=f.l.subdivideRhumbLineCount(e,t[h],t[(h+1)%m],r);for(y=new Float64Array(3*H),h=0;h<m;h++){var P;n===i.L.GEODESIC?P=f.l.subdivideLine(t[h],t[(h+1)%m],r,R):n===i.L.RHUMB&&(P=f.l.subdivideRhumbLine(e,t[h],t[(h+1)%m],r,R));for(var A=P.length,L=0;L<A;++L)y[v++]=P[L]}}var T=2*(m=y.length/3),C=c.IndexDatatype.createTypedArray(m,T);for(v=0,h=0;h<m-1;h++)C[v++]=h,C[v++]=h+1;return C[v++]=m-1,C[v++]=0,new l.d({geometry:new p.I({attributes:new u.a({position:new p.o({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})}),indices:C,primitiveType:b._0x1da42a.LINES})})}function k(e,t,r,o,n){var d=s.f.fromPoints(t,e).projectPointsOntoPlane(t,G);g.A.computeWindingOrder2D(d)===g.W.CLOCKWISE&&(d.reverse(),t=t.slice().reverse());var y,h,m=t.length,v=new Array(m),_=0;if(o)for(y=new Float64Array(2*m*3*2),h=0;h<m;++h){v[h]=_/3;var E=t[h],H=t[(h+1)%m];y[_++]=E.x,y[_++]=E.y,y[_++]=E.z,y[_++]=H.x,y[_++]=H.y,y[_++]=H.z}else{var P=0;if(n===i.L.GEODESIC)for(h=0;h<m;h++)P+=f.l.subdivideLineCount(t[h],t[(h+1)%m],r);else if(n===i.L.RHUMB)for(h=0;h<m;h++)P+=f.l.subdivideRhumbLineCount(e,t[h],t[(h+1)%m],r);for(y=new Float64Array(3*P*2),h=0;h<m;++h){var A;v[h]=_/3,n===i.L.GEODESIC?A=f.l.subdivideLine(t[h],t[(h+1)%m],r,R):n===i.L.RHUMB&&(A=f.l.subdivideRhumbLine(e,t[h],t[(h+1)%m],r,R));for(var L=A.length,T=0;T<L;++T)y[_++]=A[T]}}m=y.length/6;var C=v.length,D=2*(2*m+C),I=c.IndexDatatype.createTypedArray(m,D);for(_=0,h=0;h<m;++h)I[_++]=h,I[_++]=(h+1)%m,I[_++]=h+m,I[_++]=(h+1)%m+m;for(h=0;h<C;h++){var O=v[h];I[_++]=O,I[_++]=O+m}return new l.d({geometry:new p.I({attributes:new u.a({position:new p.o({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})}),indices:I,primitiveType:b._0x1da42a.LINES})})}function N(r){if(n.o.typeOf.object("options",r),n.o.typeOf.object("options.polygonHierarchy",r.polygonHierarchy),r.perPositionHeight&&e.e(r.height))throw new n.t("Cannot use both options.perPositionHeight and options.height");if(e.e(r.arcType)&&r.arcType!==i.L.GEODESIC&&r.arcType!==i.L.RHUMB)throw new n.t("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var o=r.polygonHierarchy,a=e.u(r.ellipsoid,t.t.WGS84),s=e.u(r.granularity,h.e.RADIANS_PER_DEGREE),p=e.u(r.perPositionHeight,!1),u=p&&e.e(r.extrudedHeight),l=e.u(r.arcType,i.L.GEODESIC),d=e.u(r.height,0),y=e.u(r.extrudedHeight,d);if(!u){var c=Math.max(d,y);y=Math.min(d,y),d=c}this._ellipsoid=t.t.clone(a),this._granularity=s,this._height=d,this._extrudedHeight=y,this._arcType=l,this._polygonHierarchy=o,this._perPositionHeight=p,this._perPositionHeightExtrude=u,this._offsetAttribute=r.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=f.l.computeHierarchyPackedLength(o)+t.t.packedLength+8}N.pack=function(i,r,o){return n.o.typeOf.object("value",i),n.o.defined("array",r),o=e.u(o,0),o=f.l.packPolygonHierarchy(i._polygonHierarchy,r,o),t.t.pack(i._ellipsoid,r,o),o+=t.t.packedLength,r[o++]=i._height,r[o++]=i._extrudedHeight,r[o++]=i._granularity,r[o++]=i._perPositionHeightExtrude?1:0,r[o++]=i._perPositionHeight?1:0,r[o++]=i._arcType,r[o++]=e.u(i._offsetAttribute,-1),r[o]=i.packedLength,r};var U=t.t.clone(t.t.UNIT_SPHERE),B={polygonHierarchy:{}};return N.unpack=function(i,r,o){n.o.defined("array",i),r=e.u(r,0);var a=f.l.unpackPolygonHierarchy(i,r);r=a.startingIndex,delete a.startingIndex;var s=t.t.unpack(i,r,U);r+=t.t.packedLength;var p=i[r++],u=i[r++],l=i[r++],d=1===i[r++],y=1===i[r++],c=i[r++],h=i[r++],g=i[r];return e.e(o)||(o=new N(B)),o._polygonHierarchy=a,o._ellipsoid=t.t.clone(s,o._ellipsoid),o._height=p,o._extrudedHeight=u,o._granularity=l,o._perPositionHeight=y,o._perPositionHeightExtrude=d,o._arcType=c,o._offsetAttribute=-1===h?void 0:h,o.packedLength=g,o},N.fromPositions=function(t){return t=e.u(t,e.u.EMPTY_OBJECT),n.o.defined("options.positions",t.positions),new N({polygonHierarchy:{positions:t.positions},height:t.height,extrudedHeight:t.extrudedHeight,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,arcType:t.arcType,offsetAttribute:t.offsetAttribute})},N.createGeometry=function(t){var i=t._ellipsoid,n=t._granularity,s=t._polygonHierarchy,u=t._perPositionHeight,l=t._arcType,c=f.l.polygonOutlinesFromHierarchy(s,!u,i);if(0!==c.length){var b,m,v,_=[],E=h.e.chordLength(n,i.maximumRadius),H=t._height,P=t._extrudedHeight;if(t._perPositionHeightExtrude||!h.e.equalsEpsilon(H,P,0,h.e.EPSILON2))for(v=0;v<c.length;v++){if((b=k(i,c[v],E,u,l)).geometry=f.l.scaleToGeodeticHeightExtruded(b.geometry,H,P,i,u),e.e(t._offsetAttribute)){var A=b.geometry.attributes.position.values.length/3,L=new Uint8Array(A);t._offsetAttribute===d.z.TOP?L=r.d(L,1,0,A/2):(m=t._offsetAttribute===d.z.NONE?0:1,L=r.d(L,m)),b.geometry.attributes.applyOffset=new p.o({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}_.push(b)}else for(v=0;v<c.length;v++){if((b=S(i,c[v],E,u,l)).geometry.attributes.position.values=g.A.scaleToGeodeticHeight(b.geometry.attributes.position.values,H,i,!u),e.e(t._offsetAttribute)){var T=b.geometry.attributes.position.values.length,C=new Uint8Array(T/3);m=t._offsetAttribute===d.z.NONE?0:1,r.d(C,m),b.geometry.attributes.applyOffset=new p.o({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}_.push(b)}var D=y.k.combineInstances(_)[0],I=o.i.fromVertices(D.attributes.position.values);return new p.I({attributes:D.attributes,indices:D.indices,primitiveType:D.primitiveType,boundingSphere:I,offsetAttribute:t._offsetAttribute})}},function(i,r){return e.e(r)&&(i=N.unpack(i,r)),i._ellipsoid=t.t.clone(i._ellipsoid),N.createGeometry(i)}}));
